#!/bin/bash

# Pre-commit hook for Claude Code marketplace and plugin validation

echo "ğŸ” Validating Claude Code marketplace..."

# Validate marketplace
if ! claude plugin validate . 2>&1 | grep -q "âœ” Validation passed"; then
    echo "âŒ Marketplace validation failed"
    exit 1
fi
echo "âœ… Marketplace validation passed"

# Find and validate all plugins
for dir in */; do
    plugin_dir="${dir%/}"
    if [ -d "$plugin_dir/.claude-plugin" ]; then
        echo "ğŸ” Validating plugin: $plugin_dir"
        if ! claude plugin validate "$plugin_dir" 2>&1 | grep -q "âœ” Validation passed"; then
            echo "âŒ Plugin $plugin_dir validation failed"
            exit 1
        fi
        echo "âœ… Plugin $plugin_dir validation passed"
    fi
done

exit 0
